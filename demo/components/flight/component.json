{
  "name": "flight",
  "description": "Clientside component infrastructure",
  "main": "lib/index.js",
  "version": "1.0.2",
  "dependencies": {
    "es5-shim": "git://github.com/kriskowal/es5-shim.git#2.0.0",
    "jquery": "1.8.3"
  },
  "readme": "#Flight: an event-driven web application framework\n\n[![Build Status](https://travis-ci.org/twitter/flight.png?branch=master)](http://travis-ci.org/twitter/flight)\n\nFlight is a lightweight, component-based JavaScript framework that maps behavior to DOM\nnodes. Twitter uses it for their web applications.\n\nComponents cannot be directly referenced, instead they communicate by triggering and subscribing to events.\nConsequently every component, and every component API, is entirely decoupled from every other component, so\nthat components are highly portable and easily testable.\n\nAs an added bonus, Flight includes a simple and safe mixin infrastructure allowing components to be easily\nextended with minimal boilerplate.\n\n**[Follow us on Twitter](https://twitter.com/flight)**\n**[Visit our Google Group](https://groups.google.com/forum/?fromgroups#!forum/twitter-flight)**\n\n## Sample App\n\nBy way of example, we've included a simple email client built over the Flight framework. The source code for this\napp is in the [demo](https://github.com/twitter/flight/tree/gh-pages/demo) directory and you can run the demo [here](http://twitter.github.com/flight/demo/).\n\n## Browser Support\n\nFlight has been tested on all major browsers: Chrome, Firefox, Safari, Opera and IE7 and upwards.\n\n## Installation\n\nTo ensure Flight is installed with the correct dependencies, we recommend using [bower](https://github.com/twitter/bower).\nYour client app will need a `component.json` file that looks something like this:\n\n    {\n      \"name\": \"myApp\",\n      \"version\": \"1.2.1\",\n      \"dependencies\": {\n        \"flight\": \"~1.0.0\"\n      }\n    }\n\nThen running `bower install` will add flight to the `components` directory of `myApp`.\n\n## Dependencies\n\nFlight uses [ES5-shim](https://github.com/kriskowal/es5-shim) to polyfill ES5 support for older browsers and [JQuery](http://jquery.com)\nfor DOM manipulation API. If you install flight with bower, these apps will be deployed in the `components`\nfolder. Additionally you will need to include an AMD implementation such as [require.js](http://requirejs.org/)\nor [loadrunner](https://github.com/danwrong/loadrunner).\n\nThese files are loaded in the sample app at `demo/index.html`.\n\n```html\n<script src='components/jquery/jquery.js'></script>\n<script src='components/es5-shim/es5-shim.js'></script>\n<script src='components/es5-shim/es5-sham.js'></script>\n<script data-main=\"requireMain.js\" src='components/requirejs/require.js'></script>\n```\n\n## How do I use it?\n\n1.  Define a component\n2.  Attach a component instance to a DOM node\n\n## Components\n\n### What is a component?\n\n- A Component is nothing more than a constructor with properties mixed into its prototype.\n- Every Component comes with a set of basic functionality such as event handling and component registration.\n- Additionally, each Component definition mixes in a set of custom properties which describe its behavior.\n- When a component is attached to a DOM node, a new instance of that component is created. Each component\ninstance references the DOM node via its `node` property.\n- Component instances cannot be referenced directly; they communicate with other components via events.\n\n### How do I define a component?\n\nFlight expects its client apps to support [AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)-style module definitions.\n\nTo define a component, create a module that depends on Flight's component module (`lib/component.js`). The\nlatter module exports a function which we'll call `defineComponent`.\n\n```js\ndefine(\n  [\n    'components/flight/lib/component'\n  ],\n\n  function(defineComponent) {\n    //..\n  }\n);\n```\n\n`defineComponent` accepts any number of [mixin](#mixins) functions and returns a new Component constructor\nwith those mixins applied to its prototype.\n\n<a name=\"core_mixin\"></a>Each Component definition should include a function declaration describing its\nbasic behavior (we can think of this function as the Component's core mixin). By passing this function to\n`defineComponent` we can define a simple Component:\n\n```js\n/* mySimpleComponent.js */\n\ndefine(\n  [\n    'components/flight/lib/component'\n  ],\n\n  function(defineComponent)  {\n\n    return defineComponent(mySimpleComponent);\n\n    function mySimpleComponent() {\n      this.doSomething = function() {\n        //...\n      }\n\n      this.doSomethingElse = function() {\n        //...\n      }\n    }\n  }\n);\n```\n\nComponents make no assumptions about the existence of other objects. If you were to remove all other\nJavaScript on the site, this component would still work as intended.\n\n### How do I attach a Component to a DOM node?\n\nEach Component constructor has an `attachTo` method which accepts two arguments. The first argument is a DOM\nnode (or a jQuery object or CSS selector representing one or more DOM nodes). The second is an `options` object.\nIf extra arguments are supplied, they are merged into the first options argument. These options will be merged\ninto the `defaults` object which is a property of the component instance.\n\nInvoking `attachTo` will create a new instance and attach it to the supplied DOM node. If the first argument\nresolves to one or more DOM nodes, an instance will be created for each node.\n\nHere we are creating an instance of an Inbox Component and attaching it to a node with id `inbox`. We're also\npassing in values for a couple of selectors which will override the values defined in the components `defaults`\nobject (if they exist). More on `defaults` [here](#defaults-and-options).\n\n```js\n/* attach an inbox component to a node with id 'inbox'*/\n\ndefine(\n  [\n    'components/inbox'\n  ],\n\n  function(Inbox) {\n    Inbox.attachTo('#inbox', {\n      'nextPageSelector': '#nextPage',\n      'previousPageSelector': '#previousPage',\n    });\n  }\n);\n```\n\nIt's important to understand that `attachTo` does not return the new instance, or any other value. You should\nnever need a reference to component instances - they should only respond to events.\n\n### Initializing a component\n\nWhen a component is created we usually want it to perform an initial setup routine. Every Component has an\nempty initialize method attached to its prototype and we can augment this method by supplying a function as\nan argument to a special `after` method. (We'll talk about `before`, `after` and `around` in detail in the\n[advice](#advice) section of this document).\n\nThe initialize function is a good place to set up event listeners that bind to callbacks.\n\n```js\ndefine(\n  [\n    'components/flight/lib/component'\n  ],\n\n  function(defineComponent)  {\n\n    return defineComponent(inbox);\n\n    function inbox() {\n      //define custom functions here\n      //...\n\n      // now initialize the component\n      this.after('initialize', function() {\n        this.on('click', doThisThing);\n        this.on('mouseover', doThatThing);\n      });\n    }\n  }\n);\n```\n### Defaults and Options\n\nIn addition to functions, most components need to define attributes too. In Flight, default values are\nassigned by passing an object to the `defaultAttrs` function\n\n```js\ndefine(\n  [\n    'flight/lib/component'\n  ],\n\n  function(defineComponent) {\n\n    return defineComponent(button);\n\n    function button() {\n      this.defaultAttrs({\n        buttonClass: 'js-button',\n        text: 'Click me'\n      });\n\n      this.after('initialize', function() {\n        //..\n      });\n    }\n\n  }\n);\n```\n\nThe object will be assigned to, or merged with, the `attr` property of the component and can be accessed\naccordingly:\n\n```js\nthis.after('initialize', function() {\n  this.$node\n      .addClass(this.attr.buttonClass)\n      .text(this.attr.text);\n});\n```\n\nThese can be overridden in options...\n\n```js\n/* attach button with text as option */\n\ndefine(\n  [\n    'components/button'\n  ],\n\n  function(Button) {\n    Button.attachTo(\"#foo\", {\n      text: \"Don't click me\",\n      buttonClass: \"js-not-a-button\"\n    });\n  }\n);\n```\n\n...or by [mixins](#overriding-defaults-in-a-mixin).\n\n### Finding elements\n\nFlight's `select` method takes a [selector attribute](#defaults-and-options) as its argument and will return\nall matching elements within the component's `node`. This is a handy alternative to jQuery's `this.$node.find()`\nand prevents accidental access to elements outside of `this.node`.\n\n```js\nthis.defaultAttrs({\n  menuItemSelector: '.menu-item',\n  selectedClass: 'selected'\n});\n\nthis.selectMenuItem = function(e) {\n  // toggle 'selected' class on all list items\n  this.select('menuItemSelector').toggleClass(this.attr.selectedClass);\n\n  //...\n};\n```\n\n### Interacting with the DOM\n\nOnce attached, component instances have direct access to their node object via the `node` property. (There's\nalso a jQuery version of the node available via the `$node` property.)\n\n### Events in Flight\n\nEvents are how Flight components interact. The Component prototype supplies methods for triggering events as\nwell as for subscribing to and unsubscribing from events. These Component event methods are actually just convenient\nwrappers around regular event methods on DOM nodes.\n\n#### Triggering events\n\nThe `trigger` method takes up to three arguments representing the triggering element, the event type (e.g.\n`'click'` or `'saveRequested'`) and the event payload which must always be an object. Only the event type is\nmandatory. If the element is not supplied then the component's `node` property is used.\n\n```js\nthis.saveButtonClicked = function() {\n  this.trigger('saveRequested', currentDocument);\n}\n\nthis.updateSuccessful = function() {\n  this.trigger(document, 'transactionComplete', successData);\n}\n```\n\nYou can also specify a default function that will be called by the component, providing nothing in the event's\nbubble chain invokes `preventDefault`. Default functions in custom events are analagous to the default behaviors\nof native events.\n\nTo define a default function, make the event argument an object that defines the event type and the `defaultFunction`.\nA common use case is defining default behavior for keyboard events:\n\n```js\nthis.trigger('#textInput', {type: 'escapePressed', defaultFunction: this.blur});\n```\n\n#### Subscribing to events\n\nA component instance can listen to an event and register a callback to be invoked using the `on` method of the\ncomponent prototype. There are three possible arguments: the DOM node to listen on, the event type to listen\nto, and the event handler (callback) to be invoked. Again the DOM node is optional and defaults to the component\ninstance's `node` value. Flight will automatically bind the context (`this`) of the callback to the component instance.\n\nThe callback argument can be either a function to be invoked...\n\n```js\nthis.after('initialize', function() {\n  this.on(document, 'dataSent', this.refreshList);\n  this.on('click', this.selectItem);\n});\n```\n\n...or an object that maps event targets to callbacks...\n\n```js\nthis.after('initialize', function() {\n  this.on('click', {\n    menuItemSelector: this.selectMenuItem,\n    saveButtonSelector: this.saveAll\n  });\n});\n```\n\nThe latter case is effectively event delegation; selector values are resolved, at event time, by keying into the `attr` property\nof the component (see [`defaults and options`](#defaults-and-options)).\nFor the above example we would expect the `defaultAttrs` call to look something like this:\n\n```js\nthis.defaultAttrs({\n  menuItemSelector: '.menuItem',\n  saveButtonSelector: '#save'\n});\n```\n\n#### Unsubscribing from events\n\nIf we no longer want a component instance to listen to an event we can use the `off` method to unsubscribe.\nThis method takes up to three arguments: the DOM node that was listening to the event, the event type, and the\ncallback. The DOM node argument is optional and defaults to the component's `node` property. The callback is\nalso optional and when not supplied the component instance detaches all callbacks for the event type.\n\n```js\nfunction disableAllDropdowns() {\n  this.off('#select', 'click');\n}\n\nfunction noHighlightOnHover() {\n  this.off('hover', this.highlight);\n}\n```\n\nNote: when a component is [torn down](#teardown), it automatically unsubscribes from all events.\n\n### Putting it together\n\nHere's an example of a navigation menu component.\n\n```js\ndefine(\n  [\n    'flight/lib/component'\n  ],\n\n  function(defineComponent) {\n\n    return defineComponent(navigationMenu);\n\n    function navigationMenu() {\n      this.defaultAttrs({\n        menuItemSelector: '.menu-item',\n        selectedClass: 'selected'\n      });\n\n      // mark menu item as selected. mark others as not selected. trigger uiLoadUrl event\n      this.selectMenuItem = function(e) {\n        // toggle 'selected' class on all list items\n        this.select('menuItemSelector').toggleClass(this.attr.selectedClass);\n\n        // let some other component worry about loading the content & displaying it\n        this.trigger('uiLoadUrl', {\n          url: $(e.target).attr('href')\n        });\n      };\n\n      this.after('initialize', function() {\n        // 'menuItemSelector' is defined in defaultAttr\n        this.on('click', {\n          menuItemSelector: this.selectMenuItem\n        });\n      });\n    }\n\n  }\n);\n```\n\nWe can attach the component to a `ul.menu` element like the one below:\n\n```html\n<nav>\n  <ul class=\"menu\">\n    <li class=\"menu-item selected\">\n      <a href=\"apage.html\">A page</a>\n    </li>\n    <li class=\"menu-item\">\n      <a href=\"anotherpage.html\">Another page</a>\n    </li>\n  </ul>\n</nav>\n```\n\nNow we have a simple menu component that can be attached to any element that has `.menu-item` children.\n\n## Teardown\n\nFlight provides a set of methods which remove components and their event bindings. It's a good idea to use teardown\ncomponents after each unit test - and teardown also good for unbinding event listeners when, for example, the user\nnavigates away from a page.\n\nThere are three levels of teardown:\n\n* On `defineComponent` (i.e. the object exported by `lib/component.js`) - deletes every instance of\nevery component and all their event bindings.\n\n```js\ndefine(\n  [\n    'flight/lib/component'\n  ],\n\n  function(defineComponent) {\n\n    return defineComponent(navigationMenu);\n\n    function navigationMenu() {\n\n      this.resetEverything = function() {\n        //remove every component instance and all event listeners\n        defineComponent.teardownAll();\n      };\n      //..\n    }\n  }\n);\n```\n\n* On a Component constructor - deletes every instance of that Component type and all their event bindings.\n\n```js\ndefine(\n  [\n    'ui/navigationMenu'\n  ],\n\n  function(NavigationMenu) {\n    //..\n    //remove all instances of NavigationMenu and all their event bindings\n    NavigationMenu.teardownAll();\n  }\n);\n```\n\n* On a component instance - deletes this instance and its event bindings\n\n```js\ndefine(\n  [\n    'flight/lib/component'\n  ],\n\n  function(defineComponent) {\n\n    return defineComponent(videoPlayer);\n\n    function videoPlayer() {\n\n      this.closeVideoWidget = function() {\n        //remove this component instance and its event bindings\n        this.teardown();\n      };\n      //..\n    }\n  }\n);\n```\n\n## Mixins\n\n- In Flight, a mixin is a function which assigns properties to a target object (represented by the `this`\nkeyword).\n- A typical mixin defines a set of functionality that will be useful to more than one component.\n- One mixin can be applied to any number of [Component](#components) definitions.\n- One Component definition can have any number of mixins applied to it.\n- Each Component defines a [*core*](#core_mixin) mixin within its own module.\n- A mixin can itself have mixins applied to it.\n\n### How do I define a mixin?\n\nMixin definitions are like Component definitions but without the call to `defineComponent`.\n\n```js\n\ndefine(\n  [],\n\n  function() {\n\n    function withDropdown() {\n      this.openDropdown = function() {\n        //...\n      };\n      this.selectItem = function() {\n        //...\n      };\n    }\n\n    // return the mixin function\n    return withDropdown;\n  }\n);\n```\n\n### How do I apply mixins to a component?\n\nIn the Component definition, pass the required mixins as arguments to the `defineComponent` function:\n\n```js\ndefine(\n  [\n    'flight/lib/component',\n    'mixins/with_dialog',\n    'mixins/with_dropdown'\n  ],\n\n  function(defineComponent, withDialog, withDropdown) {\n\n    defineComponent(fancyComponent, withDialog, withDropdown);\n\n    function fancyComponent() {\n      //...\n    }\n  }\n);\n```\n\n### How do I apply mixins to a regular object?\n\nUnder the covers, Components add mixins using Flight's `compose` module, which amongst other things, prevents\nmixins from clobbering existing method names. If you ever need to apply a mixin to something other than a\ncomponent (e.g. to another mixin), you can invoke `compose.mixin` directly:\n\n```js\ndefine(\n  [\n    'mixins/with_positioning'\n  ],\n\n  function(withPositioning) {\n\n    function withDialog() {\n      //mix withPositioning into withDialog\n      compose.mixin(this, [withPositioning]);\n\n      //...\n    }\n\n    // return the mixin function\n    return withDialog;\n  }\n);\n```\n\n### Overriding defaults in a mixin\n\nThe `defaultAttr` method is available to both component and mixin modules. When used with mixins it will not\noverwrite attributes already defined in the component module.\n\n```js\n/* mixins/big_button */\n\ndefine(\n  [],\n\n  function() {\n\n    function bigButton() {\n      this.defaultAttrs({\n        buttonClass: 'js-button-big'\n      });\n    }\n\n    return bigButton;\n\n  }\n);\n```\n## Advice\n\nIn Flight, advice is a mixin (`'lib/advice.js'`) that defines `before`, `after` and `around` methods.\n\nThese can be used to modify existing functions by adding custom code. All Components have advice mixed in to\ntheir prototype so that mixins can augment existing functions without requiring knowledge\nof the original implementation. Moreover, since Component's are seeded with an empty `initialize` method,\nComponent definitions will typically use `after` to define custom `initialize` behavior.\n\n### before and after\n\nYou can add custom code before or after an existing method by calling the respective advice function with two\narguments. The first is the name of the function you want to augment, the second is a custom function to be\ninvoked before or after the original:\n\n```js\ndefine(\n  [],\n\n  function() {\n\n    function withDrama() {\n      this.before('announce', function() {\n        clearThroat();\n      });\n      this.after('leaving', function() {\n        slamDoor();\n      });\n    }\n\n    return withDrama;\n  }\n);\n```\n\n### around\n\nThis method is similar to `before` and `after` but allows the existing function to be invoked in the middle of\nyour custom code (it's similar to [underscore](http://underscorejs.org/)'s `_wrap` function). Again the first argument is the existing function\nwhile the second is the custom function to go around it. The existing function will be passed to the custom\nfunction as an argument so that it can be referenced. If the custom function does not call the existing function\nthen it will replace that function instead of surround it:\n\n```js\ndefine(\n  [],\n\n  function() {\n\n    function withDrama() {\n      this.around('announce', function(basicAnnounce) {\n        clearThroat();\n        basicAnnounce();\n        bow();\n      });\n    }\n\n    return withDrama;\n  }\n);\n```\n\n### Making advice available to regular objects\n\nAdvice can be mixed in to non-components using the compose module:\n\n```js\n//a simple module: 'test/myObj'\ndefine(\n  [],\n\n  function() {\n    var myObj = {\n      print: function() {\n        console.log(\"hello\");\n      }\n    };\n\n    return myObj;\n  }\n);\n\n//import myObj and augment it\ndefine(\n  [\n    'lib/advice',\n    'lib/compose',\n    'test/myObj'\n  ],\n\n  function(advice, compose, myObj) {\n\n    //add advice functions to myObj\n    compose.mixin(myObj, [advice.withAdvice]);\n\n    //augment print function\n    myObj.after('print', function() {\n      console.log(\"world\");\n    });\n  }\n);\n```\n\n## Debugging\n\nFlight ships with a debug module which can help you trace the sequence of event triggering and binding. By default\nthe console will log every trigger, bind and unbind event. By sending instructions to your browser console, you\ncan filter logged events by type or by name or turn them off completely:\n\n    DEBUG.events.logByAction('trigger'); //only log event triggers\n    DEBUG.events.logByName('click'); //only log events named 'click' - accepts * as wildcard\n    DEBUG.events.logNone(); //log nothing\n    DEBUG.events.logAll(); //log everything\n\n## Authors\n\n+ [@angus-c](http://github.com/angus-c)\n+ [@danwrong](http://github.com/danwrong)\n+ [@kpk](http://github.com/kennethkufluk)\n\nThanks for assistance and contributions:\n\n+ [@sayrer](https://github.com/sayrer)\n+ [@shinypb](https://github.com/shinypb)\n+ [@kloots](https://github.com/kloots)\n+ [@marcelduran](https://github.com/marcelduran)\n+ [@tbrd](https://github.com/tbrd)\n+ [@necolas](https://github.com/necolas)\n+ [@fat](https://github.com/fat)\n+ [@mkuklis](https://github.com/mkuklis)\n+ [@jrburke](https://github.com/jrburke)\n+ [@garann](https://github.com/garann)\n+ [@WebReflection](https://github.com/WebReflection)\n+ [@coldhead](https://github.com/coldhead)\n+ [@paulirish](https://github.com/paulirish)\n+ [@nimbupani](https://github.com/nimbupani)\n+ [@mootcycle](https://github.com/mootcycle)\n\nSpecial thanks to the rest of the Twitter web team for their abundant contributions and feedback.\n\n## License\n\nCopyright 2013 Twitter, Inc and other contributors.\n\nLicensed under the MIT License\n",
  "readmeFilename": "README.md",
  "_id": "flight@1.0.2",
  "repository": {
    "type": "git",
    "url": "git://github.com/twitter/flight"
  }
}